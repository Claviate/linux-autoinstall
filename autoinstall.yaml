autoinstall:
  version: 1

  early-commands:
    - echo "Will now run automatic setup of Ubuntu for Claviate desktops with danish keyboard. Authored on 15-07-2024 by Thomas BovÃ©."
    - sleep 2
    - echo "Starting installation now"

  interactive-sections:
    - identity
    - storage
  source:
    id: ubuntu-desktop-minimal

  locale: en_US.UTF-8
  keyboard:
    layout: dk
    variant: ''
  timezone: Europe/Copenhagen

 #refresh-installer:
 # update: true

network:
  version: 2
  ethernets:
    all-eth:
      match:
        name: "en*"
      dhcp6: yes
debconf-selections: eek

  packages:
    - git
    - python3-pip
    - libreoffice

  snaps:
    - name: slack
      channel: stable
      classic: true

    - name: code
      channel: stable
      classic: true

    - name: postman
      channel: stable
      classic: true

  #storage:
  #  name: zfs
            
  late-commands:
    - curtin in-target -- curl -fsSL https://raw.githubusercontent.com/Claviate/linux-autoinstall/dev/post_inst_setup.sh -o ~/post_inst_setup.sh
#  - curtin in-target -- apt-get update
#  - curtin in-target -- apt-get install ca-certificates curl
#  - curtin in-target -- install -m 0755 -d /etc/apt/keyrings
#  - curtin in-target -- curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
#  - curtin in-target -- chmod a+r /etc/apt/keyrings/docker.asc
#  - curtin in-target -- echo \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
#    $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \ tee /etc/apt/sources.list.d/docker.list > /dev/null
#  - curtin in-target -- apt-get update
#  - curtin in-target -- apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin    

 shutdown: reboot
